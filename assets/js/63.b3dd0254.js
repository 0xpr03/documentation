(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{426:function(e,t,a){"use strict";a.r(t);var s=a(6),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"meilisearch-in-production-taking-it-to-the-next-level"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#meilisearch-in-production-taking-it-to-the-next-level"}},[e._v("#")]),e._v(" MeiliSearch in production: taking it to the next level")]),e._v(" "),a("h2",{attrs:{id:"a-quick-introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#a-quick-introduction"}},[e._v("#")]),e._v(" A quick introduction")]),e._v(" "),a("p",[e._v("Hopefully, you already know that "),a("a",{attrs:{href:"https://github.com/meilisearch/MeiliSearch",target:"_blank",rel:"noopener noreferrer"}},[e._v("MeiliSearch"),a("OutboundLink")],1),e._v(" is a powerful and fast open-source search engine built in "),a("a",{attrs:{href:"https://www.rust-lang.org",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rust"),a("OutboundLink")],1),e._v(". It was designed to provide users with a very useful and customizable search experience including out-of-the-box features such as typo-tolerance, filtering, and synonyms for any kind of project.")]),e._v(" "),a("p",[e._v("Running a Meilisearch instance for testing purposes is incredibly easy and can be done in "),a("a",{attrs:{href:"https://docs.meilisearch.com/guides/introduction/quick_start_guide.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("many ways"),a("OutboundLink")],1),e._v(": using Docker, brew, aptitude, binaries, a simple curl, or even the source code. If you are new to MeiliSearch, we suggest that you take a tour around the documentation.")]),e._v(" "),a("p",[e._v("Using MeiliSearch on your own machine for your weekend project is fun, let's agree on that. However, you may want to go live and deploy a project in production, to take it to the next level. What steps and details would you need to "),a("strong",[e._v("deploy MeiliSearch in production")]),e._v(" and ensure it is "),a("strong",[e._v("safe and ready to use")]),e._v("?")]),e._v(" "),a("h2",{attrs:{id:"content-of-this-article"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#content-of-this-article"}},[e._v("#")]),e._v(" Content of this article")]),e._v(" "),a("p",[a("RouterLink",{attrs:{to:"/resources/cookbooks/running_production.html#step-1-install-meilisearch"}},[e._v("Step 1: Install MeiliSearch")])],1),e._v(" "),a("p",[a("RouterLink",{attrs:{to:"/resources/cookbooks/running_production.html#step-2-run-meilisearch-as-a-service"}},[e._v("Step 2: Run MeiliSearch as a service")])],1),e._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/resources/cookbooks/running_production.html#_2-1-create-a-service-file"}},[e._v("2.1 Create a service file")])],1),e._v(" "),a("li",[a("RouterLink",{attrs:{to:"/resources/cookbooks/running_production.html#_2-2-enable-and-start-service"}},[e._v("2.2. Enable and start service")])],1)]),e._v(" "),a("p",[a("RouterLink",{attrs:{to:"/resources/cookbooks/running_production.html#step-3-secure-and-finish-your-setup-using-a-reverse-proxy-domain-name-and-https"}},[e._v("Step 3: Secure and finish your setup. Using a Reverse Proxy, domain name and HTTPS")])],1),e._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/resources/cookbooks/running_production.html#_3-1-creating-a-reverse-proxy-with-nginx"}},[e._v("3.1. Creating a Reverse Proxy with Nginx")])],1),e._v(" "),a("li",[a("RouterLink",{attrs:{to:"/resources/cookbooks/running_production.html#_3-2-set-up-ssl-tls-for-your-meilisearch"}},[e._v("3.2. Set up SSL/TLS for your MeiliSearch")])],1)]),e._v(" "),a("p",[a("RouterLink",{attrs:{to:"/resources/cookbooks/running_production.html#conclusion"}},[e._v("Conclusion")])],1),e._v(" "),a("h2",{attrs:{id:"get-your-meilisearch-ready-for-production"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-your-meilisearch-ready-for-production"}},[e._v("#")]),e._v(" Get your MeiliSearch ready for production")]),e._v(" "),a("p",[e._v("For this tutorial, we will be using a Debian 10 server, running on DigitalOcean. You can easily try it on your own, with plans starting at $5/month. And if you want some credits to start running your MeiliSearch and are not already registered on DigitalOcean, you can get $100 for free using "),a("a",{attrs:{href:"https://m.do.co/c/7c67bd97e101",target:"_blank",rel:"noopener noreferrer"}},[e._v("this referral link"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),a("ul",[a("li",[e._v("An up-to-date server that runs Debian 10")]),e._v(" "),a("li",[e._v("An ssh keypair to connect to that machine")])]),e._v(" "),a("blockquote",[a("p",[a("em",[e._v("TIPS:")]),e._v(" learn how to connect via SSH to your "),a("a",{attrs:{href:"https://www.digitalocean.com/docs/droplets/how-to/connect-with-ssh/",target:"_blank",rel:"noopener noreferrer"}},[e._v("DigitalOcean droplet"),a("OutboundLink")],1),e._v(" or any "),a("a",{attrs:{href:"https://phoenixnap.com/kb/ssh-to-connect-to-remote-server-linux-or-windows",target:"_blank",rel:"noopener noreferrer"}},[e._v("Linux or windows server"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"step-1-install-meilisearch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-1-install-meilisearch"}},[e._v("#")]),e._v(" Step 1: Install MeiliSearch")]),e._v(" "),a("p",[e._v("Installing and running MeiliSearch is easy and straightforward. In order to keep this tutorial as simple as possible, let's use a script that will carry out the installation process. It will copy a binary of MeiliSearch to your machine and enable you to use it immediately.")]),e._v(" "),a("p",[e._v("Once you are logged in into your machine via SSH, ensure your system and its dependencies are up-to-date before proceeding with the installation.")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Update the list of available packages and their versions")]),e._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" update\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Install curl which is required to install MeiliSearch in the next step")]),e._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -y\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Install MeiliSearch latest version from the script")]),e._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -L https://install.meilisearch.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sh")]),e._v("\n")])])]),a("blockquote",[a("p",[e._v("The different options to achieve a MeiliSearch installation are detailed in "),a("strong",[a("a",{attrs:{href:"https://docs.meilisearch.com/guides/advanced_guides/installation.html#download-and-launch",target:"_blank",rel:"noopener noreferrer"}},[e._v("this guide"),a("OutboundLink")],1)]),e._v("."),a("br"),e._v("\nIt is important to know that there are different ways to get MeiliSearch running on your machine. As an open source project, you can always compile the latest stable release of MeiliSearch from the source code to ensure the binary uses your achitecture in the best possible way.")])]),e._v(" "),a("p",[e._v("You can always check the latest MeiliSearch stable version, and get MeiliSearch for the Operating System of your choice, by visiting the following link:")]),e._v(" "),a("p",[a("strong",[a("a",{attrs:{href:"https://github.com/meilisearch/MeiliSearch/releases/latest",target:"_blank",rel:"noopener noreferrer"}},[e._v("Latest MeiliSearch Stable Version"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("MeiliSearch is finally installed and ready to use. To make it accessible from everywhere in your system, move the binary file into your system binaries folder:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Move the MeiliSearch binary to your system binaries")]),e._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" ./meilisearch /usr/bin/\n")])])]),a("p",[e._v("You can now start using MeiliSearch! In your terminal, run:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ meilisearch\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# --- Expected output for v0.10.1 ---")]),e._v("\n888b     d888          d8b "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" d8b  .d8888b.                                    "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("\n8888b   d8888          Y8P "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" Y8P d88P  Y88b                                   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("\n88888b.d88888              "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("     Y88b.                                        "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("\n888Y88888P888  .d88b.  "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Y888b.    .d88b.   8888b.  888d888 .d8888b 88888b.\n888 Y888P 888 d8P  Y8b 888 888 888     "')]),e._v("Y88b. d8P  Y8b     "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"88b 888P"')]),e._v("  d88P"),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"    888 "')]),e._v("88b\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("  Y8P  "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("88888888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("       "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"888 88888888 .d888888 888    888      888  888\n888   "')]),e._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" Y8b.     "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" Y88b  d88P Y8b.     "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("    Y88b.    "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Y8888  888 888 888  "')]),e._v("Y8888P"),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"   "')]),e._v("Y8888  "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Y888888 888     "')]),e._v("Y8888P "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("888")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2020")]),e._v("-05-04T11:47:13Z INFO  meilisearch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" Database path: "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"./data.ms"')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2020")]),e._v("-05-04T11:47:13Z INFO  meilisearch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" Start server on: "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"127.0.0.1:7700"')]),e._v("\n")])])]),a("h2",{attrs:{id:"step-2-run-meilisearch-as-a-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-2-run-meilisearch-as-a-service"}},[e._v("#")]),e._v(" Step 2: Run MeiliSearch as a service")]),e._v(" "),a("p",[e._v("In Linux environments, a "),a("code",[e._v("service")]),e._v(" is a process that can be launched when the operating system is booting and which will keep running in the background. One of its biggest advantages is making your program available at any moment. Even if some execution problems or crashes occur, the service will be restarted and your program will be run again.")]),e._v(" "),a("blockquote",[a("p",[e._v("If you are new to services and "),a("code",[e._v("systemd")]),e._v(", you can learn more about the basics of Linux services "),a("a",{attrs:{href:"https://www.hostinger.com/tutorials/manage-and-list-services-in-linux/",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("p",[e._v("In Debian and other Linux distributions, "),a("code",[e._v("systemd")]),e._v(" allows you to create and manage your own custom services. In order to make sure that MeiliSearch will always respond to your requests, you can build your own service. This way, you will ensure its availability in case of a crash or in case of system reboot. If any of these occur, "),a("code",[e._v("systemd")]),e._v(" will automatically restart MeiliSearch.")]),e._v(" "),a("h3",{attrs:{id:"_2-1-create-a-service-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-create-a-service-file"}},[e._v("#")]),e._v(" 2.1 Create a service file")]),e._v(" "),a("p",[e._v("Service files are text files that tell your operating system how to run your program, and when. They live in the "),a("code",[e._v("/etc/systemd/system")]),e._v(" directory, and your system will load them at boot time. In this case, let's use a very simple service file that will run MeiliSearch on port "),a("code",[e._v("7700")]),e._v(".")]),e._v(" "),a("p",[e._v("To run MeiliSearch in a production environment, use the "),a("code",[e._v("--env")]),e._v(" flag. To generate a master key that will let MeiliSearch create reading and writing keys, use the "),a("code",[e._v("--master-key")]),e._v(" flag. With those keys, you can easily control who can access or create new documents, indexes, or change the configuration. You can change the "),a("code",[e._v("Master Key")]),e._v(" to any value in the following command. However, for security concerns, it's better to choose a safe and random key, never share it and, just, "),a("strong",[e._v("keep it safe")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" EOF "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/etc/systemd/system/meilisearch.service\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("Unit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("Description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("MeiliSearch\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("After")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("systend-user-sessions.service\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("Type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("simple\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/usr/bin/meilisearch --http-addr "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("127.0")]),e._v(".0.1:7700 --env production --master-key Y0urVery-S3cureAp1K3y\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("Install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("default.target\nEOF\n")])])]),a("blockquote",[a("p",[e._v("For more information on MeiliSearch authentication and API keys see the "),a("strong",[a("a",{attrs:{href:"https://docs.meilisearch.com/guides/advanced_guides/authentication.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Authentication Docs"),a("OutboundLink")],1)]),e._v(". For more information on MeiliSearch options and flags see the "),a("strong",[a("a",{attrs:{href:"https://docs.meilisearch.com/guides/advanced_guides/installation.html#download-and-launch",target:"_blank",rel:"noopener noreferrer"}},[e._v("Installation Docs"),a("OutboundLink")],1)])])]),e._v(" "),a("p",[e._v("As for now, it is not time yet to expose your MeiliSearch instance to the external world. To keep running it safely inside your own environment, make it available locally at "),a("code",[e._v("127.0.0.1")]),e._v(". This means that only programs running on your machine are allowed to make requests to your MeiliSearch instance.")]),e._v(" "),a("h3",{attrs:{id:"_2-2-enable-and-start-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-enable-and-start-service"}},[e._v("#")]),e._v(" 2.2. Enable and start service")]),e._v(" "),a("p",[e._v("The service file you just built is all you need for creating your service. Now you must "),a("code",[e._v("enable")]),e._v(" it to tell the operating system that we want it to run MeiliSearch at every boot. You can then "),a("code",[e._v("start")]),e._v(" the service to make it run immediately. Ensure everything is working smoothly by checking the service "),a("code",[e._v("status")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Set the service meilisearch")]),e._v("\n$ systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" meilisearch\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Start the meilisearch service")]),e._v("\n$ systemctl start meilisearch\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Verify that the service is actually running")]),e._v("\n$ systemctl status meilisearch\n\n-"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# --- Expected output ---")]),e._v("\n● meilisearch.service - MeiliSearch\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("/etc/systemd/system/meilisearch.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" since Fri "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2020")]),e._v("-04-10 "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("14")]),e._v(":27:49 UTC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" 1min 8s ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("14960")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("meilisearch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("At this point, MeiliSearch is installed and running. It is protected from eventual crashes, system restarts, and most of the problems it could find while running. But it is still hidden and protected inside the walls (or firewalls) of your machine, and unreachable from the outside world. You can stop here if all the requests you do to MeiliSearch are done by another application living in the same machine.")]),e._v(" "),a("p",[e._v("But you probably want to open your MeiliSearch to the outside world, and for now, it is isolated. Let's fix that in a safe way.")]),e._v(" "),a("h2",{attrs:{id:"step-3-secure-and-finish-your-setup-using-a-reverse-proxy-domain-name-and-https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-3-secure-and-finish-your-setup-using-a-reverse-proxy-domain-name-and-https"}},[e._v("#")]),e._v(" Step 3: Secure and finish your setup. Using a Reverse Proxy, domain name and HTTPS")]),e._v(" "),a("p",[e._v("It's time to safely make your brand new MeiliSearch available to be requested from the outside world. For this purpose, you will use two of the main technologies available on the web: a Reverse Proxy and SSL/TLS.")]),e._v(" "),a("h3",{attrs:{id:"_3-1-creating-a-reverse-proxy-with-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-creating-a-reverse-proxy-with-nginx"}},[e._v("#")]),e._v(" 3.1. Creating a Reverse Proxy with "),a("a",{attrs:{href:"https://www.nginx.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nginx"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("A reverse proxy is basically an application that will handle every communication between the outside world and your internal applications. Nginx will receive external HTTP requests and redirect them to MeiliSearch. When MeiliSearch has done its amazing job, it will communicate its response to Nginx, which will then transfer the latter to the user who originally sent the request. This is a common way to isolate and protect any application by adding a robust, secure, and fast gate-keeper such as Nginx, one of the safest and most efficient tools available online, and of course, open-source!")]),e._v(" "),a("blockquote",[a("p",[e._v("Reverse proxies are very useful regarding security, performance, scalability, and logging concerns. If you are new to Reverse proxies, you may enjoy this article explaining the why and the how of "),a("a",{attrs:{href:"https://www.keycdn.com/support/nginx-reverse-proxy",target:"_blank",rel:"noopener noreferrer"}},[e._v("reverse proxies"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("p",[e._v("Configuring Nginx as a proxy server is really simple. First of all, install it on your machine.")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Install Nginx on Debian")]),e._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" nginx -y\n")])])]),a("p",[e._v("First, deleting the default configuration file is important as the default port for HTTP, the "),a("code",[e._v("port 80")]),e._v(", is used by Nginx by default. Thus, trying to use it for MeiliSearch will create a conflict. Replace the default file by your own configuration file. You can also make MeiliSearch listen to another port by specifying it in the Nginx configuration file, but we will not cover this option in this tutorial.")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Delete the default configuration file for Nginx")]),e._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("rm")]),e._v(" -f /etc/nginx/sites-enabled/default\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Add your configuration file specifying the Reverse Proxy settings")]),e._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" EOF "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/nginx/sites-enabled/meilisearch\nserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v(" default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(":80 default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    server_name _"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        proxy_pass  http://127.0.0.1:7700"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\nEOF\n")])])]),a("p",[e._v("Finally, enable and start the Nginx service again to make sure it is still available.")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Reload the operating system daemons / services")]),e._v("\n$ systemctl daemon-reload\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Enable and start Nginx service")]),e._v("\n$ systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" nginx\n$ systemctl restart nginx\n")])])]),a("p",[e._v("MeiliSearch is now up, deployed in a production environment, using a safe API key, and being served by a Reverse Proxy Nginx. You should now be able to send requests to your server from the outside world. Open your web browser and visit: ("),a("a",{attrs:{href:"http://your-ip-address",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://your-ip-address"),a("OutboundLink")],1),e._v("). The IP address is the same you used to connect to your machine via SSH in Step 1.")]),e._v(" "),a("blockquote",[a("p",[e._v("If you want to learn more about using Nginx as a Reverse Proxy, see "),a("a",{attrs:{href:"https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("this dedicated documentation"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("p",[e._v("The only remaining problem is that MeiliSearch processes requests via HTTP without any additional security. The content that is being transmitted over HTTP could easily be read or modified by attackers, and someone could get full or partial access to your data. In order to prevent this to happen, it's important to use the HTTPS, which will enable you to use a SSL/TLS certificate, and securely transmit data.")]),e._v(" "),a("h3",{attrs:{id:"_3-2-set-up-ssl-tls-for-your-meilisearch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-set-up-ssl-tls-for-your-meilisearch"}},[e._v("#")]),e._v(" 3.2. Set up SSL/TLS for your MeiliSearch")]),e._v(" "),a("p",[e._v("SSL will let the user or client establish an authenticated connection to MeiliSearch. In this way, a user can verify server's identity before sending sensitive data or making any request to it. Then, data is sent in an encrypted way that only MeiliSearch server will be able to decrypt, providing you a fast, reliable, and automatic layer of security.")]),e._v(" "),a("p",[e._v("In most cases, when enabling SSL, you may want to use your own domain name (or a sub-domain). The first step you need to follow is to register your own domain name and change the DNS records. To make your domain name point to your newly installed MeiliSearch server, you just need to add an "),a("code",[e._v("A record")]),e._v(" pointing to the IP address used to connect to your own server. This process is simple and fast but can vary for every domain name provider. Thus, we will not cover that process in this article.")]),e._v(" "),a("blockquote",[a("p",[e._v("When you register a domain name and add an "),a("code",[e._v("A record")]),e._v(", you should be automatically able to request MeiliSearch directly by using that domain name."),a("br"),e._v("\nTo illustrate this, if you had registered your domain name "),a("code",[e._v("example.com")]),e._v(", requesting indexes would be done at "),a("a",{attrs:{href:"http://example.com/indexes",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://example.com/indexes"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("Once your domain name has been set up, you are ready to configure SSL/TLS and use HTTPS. You have two different options to achieve this goal. The first one is using "),a("a",{attrs:{href:"https://certbot.eff.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Certbot"),a("OutboundLink")],1),e._v(", an amazing, free, and very easy to use tool. If you already have SSL certificates issued from a "),a("code",[e._v("Certificate Authority or CA")]),e._v(" for your domain name, the second option covers the steps you need to follow. Then, you will be ready to use MeiliSearch safely in production!")]),e._v(" "),a("h4",{attrs:{id:"_3-2-option-a-certbot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-option-a-certbot"}},[e._v("#")]),e._v(" 3.2. Option A: Certbot")]),e._v(" "),a("p",[e._v("Using certbot in your Linux server is very easy and straightforward. This tool will generate a free SSL/TLS certificate for your domain name, and automatically handle its installation on your server. The certbot documentation contains detailed instructions for many operating systems and servers, but we will follow the instructions for "),a("a",{attrs:{href:"https://certbot.eff.org/lets-encrypt/debianbuster-nginx",target:"_blank",rel:"noopener noreferrer"}},[e._v("Certbot on Debian with Nginx"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("First of all, install the packages on your system:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" certbot python-certbot-nginx -y\n")])])]),a("p",[e._v("Let's run the Certbot script to be guided through the installation process:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("certbot --nginx\n")])])]),a("p",[e._v("Enter your email address, agree to the Terms and Conditions, and input your domain name. You will then be prompted with these options:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(": No redirect - Make no further changes to the webserver configuration.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(": Redirect - Make all requests redirect to secure HTTPS access. Choose this "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v("\nnew sites, or "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" you"),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'re confident your site works on HTTPS. You can undo this\nchange by editing your web server'")]),e._v("s configuration.\n")])])]),a("p",[e._v("We recommend that you choose option 2, to redirect HTTP to HTTPS and always use a secure connection. You should be able to request your domain name with SSL as in "),a("code",[e._v("https://example.com")]),e._v(" or "),a("code",[e._v("https://example.com/indexes")]),e._v(".")]),e._v(" "),a("h4",{attrs:{id:"_3-2-option-b-custom-ssl-tls-certificates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-option-b-custom-ssl-tls-certificates"}},[e._v("#")]),e._v(" 3.2. Option B: Custom SSL/TLS Certificates")]),e._v(" "),a("p",[e._v("When a "),a("code",[e._v("Certificate Authority")]),e._v(" issues a SSL certificate for you, you receive at least two files with encrypted keys:")]),e._v(" "),a("ul",[a("li",[e._v("Your "),a("strong",[e._v("certificate")]),e._v(" (commonly named "),a("code",[e._v("your_domain_name.pem")]),e._v(" or "),a("code",[e._v("example.pem")]),e._v(")")]),e._v(" "),a("li",[e._v("Your "),a("strong",[e._v("key")]),e._v(" (commonly named "),a("code",[e._v("your_domain_name.key")]),e._v(" or "),a("code",[e._v("example.key")]),e._v(")")])]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("example.pem")]),e._v(" and "),a("code",[e._v("example.key")]),e._v(" will be used in the following examples. Make sure to replace "),a("code",[e._v("example")]),e._v(" by the names of your own certificate files.")])]),e._v(" "),a("p",[e._v("All you need to do is store the certificate files in a secure location and use appropriate file system security permissions. Then, set the location of the certificates in Nginx configuration. It is also strongly recommended to redirect all HTTP requests to HTTPS (port 80 to 443).")]),e._v(" "),a("p",[e._v("First, let's copy your certificate files in their conventional directory so the server can find them:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Create a directory /etc/ssl/example to store the certificate files")]),e._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -p /etc/ssl/example\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Move your files to /etc/ssl/example. We will suppose that your")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# files are called example.pem and example.key")]),e._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" path-to-your-files/example.pem /etc/ssl/example/\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" path-to-your-files/example.key /etc/ssl/example/\n")])])]),a("p",[e._v("Finally, we create a new Nginx configuration file, and restart the daemons and Nginx service")]),e._v(" "),a("blockquote",[a("p",[e._v("Remember to replace "),a("code",[e._v("example.com")]),e._v(" in both "),a("code",[e._v("server_name")]),e._v(" fields with your "),a("strong",[e._v("own domain name")])])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Replace example.com in both `server_name` fields with your own domain name")]),e._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" EOF "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /etc/nginx/sites-enabled/meilisearch\nserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      listen "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v(" default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n      listen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(":80 default_server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n      server_name example.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("return")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("301")]),e._v(" https://"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$server_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$request_uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\nserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    server_name example.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        proxy_pass  http://127.0.0.1:7700"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n    listen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(":443 ssl "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ipv6only")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("443")]),e._v(" ssl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n    access_log /var/log/nginx/nginx.vhost.access.log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    error_log /var/log/nginx/nginx.vhost.error.log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    ssl_certificate /etc/ssl/example/example.pem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    ssl_certificate_key /etc/ssl/example/example.key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\nEOF\n\n$ systemctl restart nginx\n")])])]),a("p",[e._v("Your SSL certificates should be working and Nginx should be able to find them. Every request to "),a("code",[e._v("http://example.com")]),e._v(" will now be redirected to "),a("code",[e._v("https://example.com")])]),e._v(" "),a("h2",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),a("p",[e._v("You have followed the main steps to provide a safe and stable service. Your MeiliSearch instance should be up and running, in a safe environment and ready to stay available even when the most common issues occur. In addition, it is protected by a reverse proxy with your own domain name and API key, so your data and configuration are accessible only to trusted clients. Communication with your server is now encrypted. Furthermore, its identity will be verified every time before sending sensitive data in a fast and automated manner.")]),e._v(" "),a("p",[e._v("You are now ready to start using your "),a("strong",[e._v("Production-ready MeiliSearch")]),e._v("!")]),e._v(" "),a("blockquote",[a("p",[e._v("MeiliSearch is a database which means that it needs a file system it can write to, and which must be persistent.")])])])}),[],!1,null,null,null);t.default=n.exports}}]);